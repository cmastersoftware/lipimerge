# Lipimerge

A Python application that merges multiple Excel input files and generates a combined output file.  

The inputs are export files generated by LipidQuant.
The merge algorithm preserves all records for every lipid class found in any of the input files.
If a particular lipid class is missing in some files, the algorithm inserts empty columns in their place
to maintain a consistent structure across the merged output.

Basic sanity check is provided that there are no missing data in a column or 
a row in an input file; **completely** empty columns or rows are allowed and removed
from the final merge.

Supports both command-line and graphical user interface (GUI) usage.

## Features

- Accepts multiple `.xls`, `.xlsx`, or `.xlsm` files as input
- Requires one output file (`-o output.xlsm`)
- Launches a GUI if run without arguments
- Remembers last used directory across sessions
- Drag and drop support for input files in the GUI

## Usage

### Initialization

Run `setup.bat` on Windows or `setup.sh` on Linux. This:
- Creates python virtual environment (`.venv`)
- Installs dependencies

### Command Line

```bash
python lipimerge.py input1.xlsm input2.xlsm -o output.xlsm
```

### GUI Mode

Simply run:

```bash
python lipimerge.py
```

Then use the GUI to select input and output files.

### Help & Version

```bash
python lipimerge.py -h      # show help
python lipimerge.py -v      # show version
```

## Non-Standard Dependencies

See `requirements.txt`
